<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <title>SSN Social Network</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
        <h:outputStylesheet name="css/UserPage.css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        
        <title>SSN Social Network</title>
    </h:head>
    <h:body>
        <div class="logo-container">
            <img src="https://sb.pandasoft.at/public/img/pandalogo.png" alt="Logo SSN Social Network" />
        </div>
        <div class="block">
            <div class="columns">
                <!-- TODO: maybe implement search bar later
                <h:form style="display: flex;">
                    <p:inputText id="searchField" placeholder="Recherche..." style="flex-grow: 1;"/>
                    <p:commandButton value="Chercher" action="#{searchBean.search()}" icon="pi pi-search" styleClass="search-button"/>
                </h:form>
                -->
                <div class="column is-one-fifth fixed-column">
                    <center>
                        <div class="image is-128x128">
                            <img class="is-rounded" src="https://m.media-amazon.com/images/I/715W4fCS2ZL._UC256,256_CACC,256,256_.jpg" alt="User Picture"/>
                        </div>
                        <h:outputText value="#{loginBean.getCurrentUser().username}" styleClass="is-size-5 m-2" />
                        <!-- User Buttons -->
                        <h:form>
                            <p:commandButton value="Home" icon="pi pi-home" styleClass="bbutton" />
                            <p:commandButton value="Friends" icon="pi pi-users" styleClass="button" />
                            <p:button value="My Posts" icon="pi pi-align-justify" styleClass="button"
                                                outcome="/PostPage/MyPosts.xhtml?faces-redirect=true"/>
                            <p:button value="Publish" icon="pi pi-pencil" styleClass="button"
                                             outcome="/PostPage/CreatePostPage.xhtml?faces-redirect=true" />
                        </h:form>
                        <div class="menu-button-container">
                        <h:form>
                            <p:growl id="messages" showDetail="false"/>
                            <p:commandButton id="dynaButton" value="RÃ©glages" type="button" icon="pi pi-cog" styleClass="button"/>
                            <p:menu overlay="true" trigger="dynaButton" my="left top" at="left bottom">
                                <p:submenu label="Your Profile">
                                    <p:menuitem value="Preferences" action="#{menuView.save}" update="messages" icon="pi pi-cog"/>
                                    <p:menuitem value="View your profile" action="#{userBean.goToProfilePage(loginBean.currentUser)}" update="messages" icon="pi pi-user"/>
                                </p:submenu>
                                <p:submenu label="Your Activity">
                                    <p:menuitem value="your stats " action="#{menuView.delete}" update="messages" ajax="false" icon="pi pi-chart-line"/>
                                </p:submenu>
                                <p:submenu label="Logout">
                                    <p:menuitem value="Log-out" url="http://www.primefaces.org" icon="pi pi-sign-out"/>
                                    <p:menuitem value="Delete your account" icon="pi pi-trash"/>
                                </p:submenu>
                            </p:menu>
                        </h:form>
                    </div>
                    </center>
                </div>
                <div class="column main-content">
                    <ui:repeat value="#{postBean.getPosts()}" var="post">
                        <h:form>
                            <h:commandLink class="box mx-3" style="cursor: pointer;"
                                           action="#{postBean.setSelectedPost(post.id)}">
                                <h:outputText styleClass="is-size-5" value="#{userBean.getUserFromId(post.userId).getUsername()}" />
                                <br/>
                                <h:outputText styleClass="is-size-7" value="#{post.datePublished}" />
                                <br/>
                                <h:outputText styleClass="is-size-4" value="#{post.text}" />
                                <hr/>
                                <center>
                                    <div class="columns">
                                        <div class="column is-half small-padding">
                                            <h:outputText styleClass="is-size-5" value="#{post.getLikes().size()}" />
                                            <span class="icon">
                                                <i class="fas fa-heart"></i>
                                            </span>
                                        </div>
                                        <div class="column is-half small-padding">
                                            <h:outputText styleClass="is-size-5" value="#{post.getComments().size()}" />
                                            <span class="icon">
                                                <i class="fas fa-comment"></i>
                                            </span>
                                        </div>
                                    </div>
                                </center>
                            </h:commandLink>
                        </h:form>
                    </ui:repeat>
                </div>
            </div>
        </div>
    </h:body>
</html>
